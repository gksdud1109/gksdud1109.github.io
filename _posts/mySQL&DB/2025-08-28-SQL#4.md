---
title: "[MySQL]mysql#4"
date: 2025-08-28 09:00:00 +0900
categories: [Database]
tags: [database, sql]
---
## 연습1

### create table, insert into, alter table, not null

```sql
# 기존에 a2 데이터베이스가 존재 한다면 삭제
drop database if exists a2;
# 새 데이터베이스(`a2`) 생성
create database a2;
# 새 데이터베이스(`a2`) 선택
use a2;
# article 테이블 생성(id, regDate, title, body)
create table article (
	id int(10),
    regDate datetime,
    title varchar(100),
    body text
);
# article 테이블 조회(*)
desc article;
select * from article;
# article 테이블에 data insert (regDate = NOW(), title = '제목', body = '내용')
insert into article
set regdate = now(),
title = '제목',
body = '내용';
# article 테이블에 data insert (regDate = NOW(), title = '제목', body = '내용')
insert into article
set regDate = now(),
title = '제목',
body = '내용';
# aricle 테이블 조회(*)
## id가 NULL인 데이터 생성이 가능하네?
select * from article;
# id 데이터는 꼭 필수 이기 때문에 NULL을 허용하지 않게 바꾼다.(alter table, not null)
## 기존의 NULL값 때문에 실패가 뜬다.
desc article;

alter table article
modify id int(10) not null;
# 기존의 NULL값이 0으로 바뀐다.
update article
set id = 0;
# NULL을 허용하지 않게 바꾼다.(alter table, not null)
alter table article
modify id int(10) not null;
# article 테이블 조회(*)
select * from article;
desc article;
# 생각해 보니 모든 행(row)의 id 값은 유니크 해야한다.(ADD PRIMARY KEY(id))
## 오류가 난다. 왜냐하면 기존의 데이터 중에서 중복되는게 있기 때문에
alter table article add primary key(id);

select * from article;
# id가 0인 것 중에서 1개를 id 1로 바꾼다.
update article
set id = 1
limit 1;
# article 테이블 조회(*)
select * from article;
# id가 0인것을 id 2로 바꾼다.
update article
set id = 2
where id = 0;
# 생각해 보니 모든 행(row)의 id 값은 유니크 해야한다.(ADD PRIMARY KEY(id))
## 이제 적용이 잘 된다.
alter table article add primary key(id);

desc article;
# id 칼럼에 auto_increment 를 건다.
## auto_increment 를 걸기전에 해당 칼럼은 무조건 key 여야 한다.
alter table article modify id int(10) not null auto_increment;
# article 테이블 구조확인(desc)
desc article;

insert into article
set title = '제목',
body = '내용',
regDate = now();

select * from article;

# 나머지 칼럼 모두에도 not null을 적용해주세요.
## 이후 모든 칼럼에서 not null 은 기본입니다.
desc article;

alter table article modify regDate datetime not null;
alter table article modify title varchar(100) not null;
alter table article modify body text not null;
# id 칼럼에 UNSIGNED 속성을 추가하세요.
## 이후 모든 int 칼럼에서 음수를 넣을 필요가 없다면 UNSIGNED 는 기본입니다.
alter table article modify id int(10) unsigned not null auto_increment;

desc article;
```

### alter table modify/add, insert into, 간단한 조회문

```sql
# 작성자(writer varchar(100)) 칼럼을 title 칼럼 다음에 추가해주세요.
## 이후 모든 문자열 칼럼은 varchar(100) 이 기본입니다.
alter table article add writer varchar(100) after title;

select * from article;
# 작성자(writer) 칼럼의 이름을 nickname 으로 변경해주세요.(ALTER TABLE article CHANGE oldName newName TYPE 조건)
alter table article change writer nickname varchar(100);

select * from article;
# nickname 칼럼의 위치를 body 밑으로 보내주세요.(MODIFY COLUMN nickname)
alter table article modify nickname varchar(100) after body;

select * from article;
# hit 조회수 칼럼 추가 한 후 삭제해주세요.
alter table article add hit int(10);

select * from article;

alter table article drop hit;
# hit 조회수 칼럼을 다시 추가
alter table article add hit int(10) unsigned not null;

select * from article;
# 기존의 비어있는 닉네임 채워넣기(무명)
update article set nickname = '무명';

select * from article;
# article 테이블에 데이터 추가(regDate = NOW(), title = '제목3', body = '내용3', nickname = '홍길순', hit = 10)
insert into article
set regDate = now(),
title = '제목3',
body = '내용3',
nickname = '홍길순',
hit = 10;
# article 테이블에 데이터 추가(regDate = NOW(), title = '제목4', body = '내용4', nickname = '홍길동', hit = 55)
insert into article
set regDate = now(),
title = '제목4',
body = '내용4',
nickname = '홍길동',
hit = 55;
# article 테이블에 데이터 추가(regDate = NOW(), title = '제목5', body = '내용5', nickname = '홍길동', hit = 10)
insert into article
set regDate = now(),
title = '제목5',
body = '내용5',
nickname = '홍길동',
hit = 10;
# article 테이블에 데이터 추가(regDate = NOW(), title = '제목6', body = '내용6', nickname = '임꺽정', hit = 100)
insert into article
set regDate = now(),
title = '제목6',
body = '내용6',
nickname = '임꺽정',
hit = 100;
# 조회수 가장 많은 게시물 3개 만 보여주세요., 힌트 : ORDER BY, LIMIT
select *
from article
order by hit desc
limit 3;
# 작성자명이 '홍길'로 시작하는 게시물만 보여주세요., 힌트 : LIKE '홍길%'
select *
from article
where nickname like '홍길%';
# 조회수가 10 이상 55 이하 인것만 보여주세요., 힌트 : WHERE 조건1 AND 조건2
select *
from article
where hit between 10 and 55;
# 작성자가 '무명'이 아니고 조회수가 50 이하인 것만 보여주세요., 힌트 : !=
select *
from article
where nickname != '무명' and hit <= 50;
# 작성자가 '무명' 이거나 조회수가 55 이상인 게시물을 보여주세요. 힌트 : OR
select *
from article
where nickname = '무명' or hit >= 55;
```

## 연습2

```sql
DROP DATABASE mall;

CREATE DATABASE mall;

USE mall;

CREATE TABLE t_shopping(
id INT(5) PRIMARY KEY AUTO_INCREMENT,
userId CHAR(30) NOT NULL,
userPw CHAR(30) NOT NULL,
userName CHAR(30) NOT NULL,
address CHAR(50) NOT NULL,
pname CHAR(50) NOT NULL,
price INT(5) NOT NULL
);

...데이터들 집어넣는 쿼리 생략...
```

### where절 다루기, distinct, group by, count(), sum()

```sql
# 테이블 1개 버전
# 1. 손흥민의 주문 개수는? ???
select count(*) as '주문 개수'
from t_shopping
where userName = '손흥민';

# 2. 손흥민이 산 상품은? ???
select pname
from t_shopping
where userName = '손흥민';

# 3. 스커트를 산 사람은? ???
select distinct userName
from t_shopping
where pname = '스커트';

# 4. 가장 많이 주문한 사람의 아이디와 이름, 주문개수는? ???
select userId, userName, count(*) as 'order_count'
from t_shopping
group by userId, userName
order by order_count desc
limit 1;

# 5. 소지섭이 사용한 총 금액은? ???
select userName, sum(price) as 'price_sum'
from t_shopping
where userName='소지섭'
group by userName;
```
