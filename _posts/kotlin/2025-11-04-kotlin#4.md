---
title: "[Kotlin#4] ì½”í‹€ë¦° ê¶ê¸ˆí•œ ì  & ê¸°ì´ˆë¬¸ë²• ì •ë¦¬"
date: 2025-11-04 09:00:00 +0900
categories: [Kotlin]
tags: [programming, kotlin]
---
```kotlin
class Ut {
    object jwt {

        @JvmStatic
        fun toString(secret: String, expireSeconds: Long, body: Map<String, Any>): String {
            val issuedAt = Date()
            val expiration = Date(issuedAt.time + 1000L * expireSeconds)
            val secretKey: Key = Keys.hmacShaKeyFor(secret.toByteArray(StandardCharsets.UTF_8))

            return Jwts.builder()
                .claims(body)
                .issuedAt(issuedAt)
                .expiration(expiration)
                .signWith(secretKey)
                .compact()
        }

        fun isValid(jwt: String?, secretPattern: String): Boolean{
            if(jwt.isNullOrBlank()) return false

            val secretKey = Keys.hmacShaKeyFor(secretPattern.toByteArray(StandardCharsets.UTF_8))
            return runCatching {
                Jwts.parser()
                    .verifyWith(secretKey)
                    .build()
                    .parseSignedClaims(jwt)
            }.isSuccess
        }

        fun payloadOrNull(jwt: String?, secretPattern: String): Map<String, Any>?{
            if(jwt.isNullOrBlank() || !isValid(jwt,secretPattern)) return null

            val secretKey = Keys.hmacShaKeyFor(secretPattern.toByteArray(StandardCharsets.UTF_8))
            return runCatching {
                val parsed = Jwts.parser()
                    .verifyWith(secretKey)
                    .build()
                    .parseSignedClaims(jwt)

                parsed.payload as Map<String, Any>
            }.getOrNull()
        }
    }
}

```

# ìë°”ì—ì„œì˜ ì •ì  ìœ í‹¸ êµ¬ì¡°ë€?

ìë°”ì—ì„œëŠ” ê³µìš©(static) ë©”ì„œë“œë§Œ ìˆëŠ” ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¥¼ ìì£¼ ë§Œë“ ë‹¤.

```java
public class MathUtil {
    public static int add(int a, int b) {
        return a + b;
    }
}
```

-	MathUtil.add(3, 4) ì´ë ‡ê²Œ í´ë˜ìŠ¤ ì´ë¦„ìœ¼ë¡œ ë°”ë¡œ í˜¸ì¶œ ê°€ëŠ¥
-	ê°ì²´ ìƒì„±(new MathUtil())ì´ í•„ìš” ì—†ìŒ
-	ì´ëŸ° ê±¸ â€œì •ì  ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤â€ë¼ê³  ë¶€ë¦„

# ê·¸ëŸ°ë° Kotlinì—ëŠ” staticì´ ì—†ìŒ

Kotlinì€ static í‚¤ì›Œë“œë¥¼ ì—†ì• ê³  ëŒ€ì‹  object í‚¤ì›Œë“œë¡œ ì‹±ê¸€í„´(Singleton) ê°ì²´ë¥¼ ì •ì˜í•¨.
ì¦‰, objectëŠ” í´ë˜ìŠ¤ ì„ ì–¸ + ì¸ìŠ¤í„´ìŠ¤ 1ê°œ ìƒì„±ì´ ë™ì‹œì— ì¼ì–´ë‚˜ëŠ” ê°œë…ì„.

## Kotlinì—ì„œì˜ ì •ì  ìœ í‹¸ êµ¬ì¡°

ìë°”ì˜ static ìœ í‹¸ í´ë˜ìŠ¤ ëŒ€ì‹  Kotlinì—ì„œëŠ” ì´ëŸ° ì‹ìœ¼ë¡œ ì •ì˜í•¨ ğŸ‘‡

```kotlin
object MathUtil {
    fun add(a: Int, b: Int): Int = a + b
}
```

â¡ï¸ ì´ë ‡ê²Œ í•˜ë©´,
-	ê°ì²´ë¥¼ ë§Œë“¤ì§€ ì•Šì•„ë„ (new ë¶ˆí•„ìš”)
-	ì–¸ì œë“  ë°”ë¡œ MathUtil.add(3, 4) í˜¸ì¶œ ê°€ëŠ¥
-	ë‚´ë¶€ì ìœ¼ë¡œëŠ” MathUtilì´ë¼ëŠ” ì „ì—­ ì‹±ê¸€í„´ ê°ì²´ë¡œ ê´€ë¦¬ë¨

## ì˜ˆì‹œì½”ë“œ êµ¬ì¡°ì—ì„œëŠ”

```kotlin
class Ut {
    object jwt {
        fun toString(...) { ... }
        fun isValid(...) { ... }
        fun payloadOrNull(...) { ... }
    }
}
```
ì´ê±´ ìë°”ë¡œ ì¹˜ë©´ ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ì¸ê±°ì„ğŸ‘‡

```java
public class Ut {
    public static class jwt {
        public static String toString(...) { ... }
        public static boolean isValid(...) { ... }
        public static Map<String, Object> payloadOrNull(...) { ... }
    }
}
```
-	UtëŠ” ìµœìƒìœ„ â€œìœ í‹¸ í´ë˜ìŠ¤â€
-	jwtëŠ” ê·¸ ì•ˆì˜ â€œì •ì  ìœ í‹¸ ê°ì²´â€
-	í˜¸ì¶œí•  ë•ŒëŠ” Ut.jwt.toString()ì²˜ëŸ¼ ì •ì  ì ‘ê·¼ì´ ê°€ëŠ¥


## ì •ë¦¬ â€” Kotlinì—ì„œ objectì˜ ì—­í• 

| êµ¬ë¶„ | Java | Kotlin |
|:---|:---|:---|
|static ë©”ì„œë“œ | public static void foo()| object Foo { fun bar() }|
|í˜¸ì¶œ ë°©ì‹ | Foo.bar() | Foo.bar() (ë™ì¼) |
|ë©”ëª¨ë¦¬ ìƒì„± | í´ë˜ìŠ¤ ë¡œë”© ì‹œ ìƒì„±ë˜ì§€ ì•ŠìŒ (ì •ì ) | ëŸ°íƒ€ì„ ì‹œ ìµœì´ˆ ì ‘ê·¼ ì‹œì ì— 1íšŒ ìƒì„± (ì‹±ê¸€í„´) |
|ê°ì²´ ìƒì„± í•„ìš” ì—¬ë¶€ | âŒ ì—†ìŒ | âŒ ì—†ìŒ |


# ìë°” í…ŒìŠ¤íŠ¸ì½”ë“œì—ì„œ í˜¸ì¶œí–ˆì„ ë•Œì˜ ë¬¸ì œ

```java
@Test
@DisplayName("ê¸€ ì‘ì„±, ìœ íš¨í•œ ì—‘ì„¸ìŠ¤ í† í°, ì˜ëª»ëœ apiKey")
void t8() throws Exception {
    String title = "ì œëª©ì…ë‹ˆë‹¤";
    String content = "ë‚´ìš©ì…ë‹ˆë‹¤";
    Member author = memberRepository.findByUsername("user1").get();

    String accessToken = Ut.jwt.toString(
            secretPattern,
            expireSeconds,
            Map.of(
                    "id", author.getId(),
                    "username", author.getUsername(),
                    "nickname", author.getNickname()
            )
    );
(... ìƒëµ)
}
```

## @JvmStaticì„ ì§€ìš°ë©´ toStringì„ í˜¸ì¶œí•  ìˆ˜ ì—†ìŒ

ì™œëƒë©´

```
Ut.jwt.toString(secretPattern, expireSeconds, Map.of(...));
```

ì´ ì½”ë“œê°€ "ì •ì  ë©”ì„œë“œ í˜¸ì¶œ" ì²˜ëŸ¼ í•´ì„ë˜ì§€ë§Œ, kotlinì—ì„œëŠ” object ë‚´ë¶€ì˜ í•¨ìˆ˜ëŠ” ì‹¤ì œë¡œëŠ” ì •ì ì´ ì•„ë‹˜

## Kotlinì˜ object ë‚´ë¶€ í•¨ìˆ˜ëŠ” ì‹¤ì œë¡œ ì´ë ‡ê²Œ ì»´íŒŒì¼ëŒ

```java
class Ut {
    object jwt {
        fun toString(...) = ...
    }
}
```
JVM ë°”ì´íŠ¸ì½”ë“œë¡œ ë³´ë©´ ëŒ€ëµ ì´ëŸ° í˜•íƒœë¡œ ë³€í™˜ëŒğŸ‘‡
```
public final class Ut {
    public static final class jwt {
        public static final jwt INSTANCE = new jwt();

        public String toString(String secret, long expireSeconds, Map<String, Object> body) {
            ...
        }
    }
}
```

ì¦‰,
-	jwtëŠ” ì‹¤ì œë¡œ í´ë˜ìŠ¤(Ut$jwt) + ì „ì—­ ì¸ìŠ¤í„´ìŠ¤(INSTANCE)ë¡œ ë§Œë“¤ì–´ì§€ê³ 
-	ê·¸ ì•ˆì˜ toString()ì€ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œë¡œ ì¡´ì¬í•¨.

ê·¸ë˜ì„œ ìë°”ì—ì„œ í˜¸ì¶œí•˜ë ¤ë©´ ì´ë ‡ê²Œ í•´ì•¼í•¨ ğŸ‘‡
```java
Ut.jwt.INSTANCE.toString(...);
```

ê·¸ë˜ì„œ @JvmStaticì´ ì—†ìœ¼ë©´ ì•ˆëœë‹¤.

## ìœ„ì™€ ê°™ì´ ë˜ëŠ” ì´ìœ : 

### ObjectëŠ” Kotlinì˜ ëŸ°íƒ€ì„ ì‹±ê¸€í„´


```kotlin
object JwtUtil {
    fun encode() = println("encode")
}
```

```java
public final class JwtUtil {
    public static final JwtUtil INSTANCE = new JwtUtil(); // â† ì—¬ê¸°ì„œ ì‹±ê¸€í„´ ë³´ì¥ë¨

    private JwtUtil() {} // ìƒì„±ìëŠ” private

    public final void encode() {
        System.out.println("encode");
    }
}

```

ğŸ’¡ ì¦‰, objectëŠ”
-	ì»´íŒŒì¼ ì‹œ **í´ë˜ìŠ¤ 1ê°œ(JwtUtil)** ì™€
-	ë‚´ë¶€ì— INSTANCE ì •ì  í•„ë“œ 1ê°œê°€ ë§Œë“¤ì–´ì§.
-	ì´ í•„ë“œì— ë‹¨ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ë‹´ê¹€.

ê·¸ë˜ì„œ Kotlinì—ì„œ JwtUtil.encode()ë¼ê³  ì“°ë©´ <br>
â†’ ì»´íŒŒì¼ëŸ¬ê°€ ë‚´ë¶€ì ìœ¼ë¡œ JwtUtil.INSTANCE.encode()ë¡œ ë°”ê¿”ì¤Œ.<br>
(Kotlin ì»´íŒŒì¼ëŸ¬ê°€ ìë™ìœ¼ë¡œ â€œstaticì²˜ëŸ¼â€ sugar syntaxë¡œ ë°”ê¿”ì£¼ëŠ” ê±°ì„.)

### ìë°”ì—ì„œ ë¶€ë¥´ë©´ staticì²˜ëŸ¼ ì•ˆ ë˜ëŠ” ì´ìœ 

Kotlin ë‚´ë¶€ì—ì„œëŠ” sugar syntax (JwtUtil.encode())ë¥¼ ì œê³µí•˜ì§€ë§Œ
JavaëŠ” Kotlinì˜ ë¬¸ë²•ì„ ëª¨ë¦„.

ê·¸ë˜ì„œ Javaì—ì„œ ë³´ë©´ **â€œencodeëŠ” ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œâ€** ì¸ ê±°ì„.
ì¦‰, ì´ë ‡ê²Œ í•´ì•¼ ì ‘ê·¼ ê°€ëŠ¥ ğŸ‘‡

```java 
JwtUtil.INSTANCE.encode();
```

### ê·¸ëŸ¼ @JvmStaticì€ ì™œ í•„ìš”í•œê°€?

@JvmStaticì€ â€œì´ í•¨ìˆ˜ë¥¼ ì§„ì§œ static ë©”ì„œë“œë¡œë„ ë™ì‹œì— ìƒì„±í•˜ë¼â€ëŠ” ì˜ë¯¸ì„.

ì˜ˆë¥¼ ë“¤ì–´ ğŸ‘‡

```kotlin
object JwtUtil {
    @JvmStatic
    fun encode() = println("encode")
}
```
ê·¸ëŸ¼ ì»´íŒŒì¼ëœ ìë°” ë°”ì´íŠ¸ì½”ë“œì—ì„œëŠ” ì´ë ‡ê²Œ ëŒğŸ‘‡
```
public final class JwtUtil {
    public static final JwtUtil INSTANCE = new JwtUtil();

    private JwtUtil() {}

    // ì›ë˜ì˜ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ
    public final void encode() { ... }

    // ì¶”ê°€ë¡œ ìƒì„±ëœ ì§„ì§œ static ë©”ì„œë“œ
    public static void encode() { 
        INSTANCE.encode(); 
    }
}
```

# companion object

companion objectëŠ” **í´ë˜ìŠ¤ ë‚´ë¶€ì˜ â€œì •ì  ì˜ì—­â€** ì„ í‰ë‚´ ë‚´ëŠ” êµ¬ì¡°ì„.

ì˜ˆë¥¼ ë“¤ì–´ ğŸ‘‡
```kotlin
class JwtUtil {
    companion object {
        fun encode() = println("encode")
    }
}
```

ë°”ì´íŠ¸ì½”ë“œë¡œëŠ” ì´ë ‡ê²Œ ë‚˜ì˜´ğŸ‘‡
```java
public final class JwtUtil {
    public static final class Companion {
        public void encode() { ... }
    }

    public static final Companion Companion = new Companion();  // â† ì—¬ê¸°ì— ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
}
```

ì¦‰,
-	JwtUtil.Companion.encode() ì´ë ‡ê²Œ ì ‘ê·¼í•´ì•¼ í•¨
-	Kotlinì—ì„œëŠ” JwtUtil.encode()ë¡œ sugar ì²˜ë¦¬ë¨ (ë§ˆì¹˜ staticì²˜ëŸ¼)
-	Javaì—ì„œëŠ” JwtUtil.Companion.encode()ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥ âŒ

ìë°”ì—ì„œ ê·¸ëŒ€ë¡œ JwtUtil.encode()ë¡œ ë¶€ë¥´ê³  ì‹¶ë‹¤ë©´
â†’ ì—¬ê¸°ë„ @JvmStaticì„ ë¶™ì—¬ì•¼ í•¨.

```kotlin
class JwtUtil {
    companion object {
        @JvmStatic
        fun encode() = println("encode")
    }
}
```