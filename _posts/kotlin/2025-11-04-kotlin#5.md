---
title: "[Kotlin#5] ì½”í‹€ë¦° ê¶ê¸ˆí•œ ì  & ê¸°ì´ˆë¬¸ë²• ì •ë¦¬"
date: 2025-11-04 09:00:00 +0900
categories: [Kotlin]
tags: [programming, kotlin]
---
# GlobalExceptionHandler ë¦¬íŒ©í„°ë§ ì½”ë“œ

```kotlin
@ControllerAdvice
class GlobalExceptionHandler {
    @ExceptionHandler(NoSuchElementException::class)
    @ResponseBody
    fun handleException(e: NoSuchElementException?): RsData<Void?> =
        RsData("404-1","ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ì…ë‹ˆë‹¤.")

    @ExceptionHandler(MethodArgumentNotValidException::class)
    @ResponseBody
    fun handleException(e: MethodArgumentNotValidException): RsData<Void?> {
        val message = e.bindingResult.allErrors
            .filterIsInstance<FieldError>()
            .sortedWith(compareBy({ it.field }, { it.code }))
            .joinToString("\n") { "${it.field}-${it.code}-${it.defaultMessage}"}

        return RsData("400-1", message)
    }

    @ExceptionHandler(HttpMessageNotReadableException::class)
    @ResponseBody
    fun handleException(e: HttpMessageNotReadableException?): RsData<Void?> =
        RsData<Void?>("400-2", "ì˜ëª»ëœ í˜•ì‹ì˜ ìš”ì²­ ë°ì´í„°ì…ë‹ˆë‹¤.")

    @ExceptionHandler(ServiceException::class)
    @ResponseBody
    fun handleException(e: ServiceException): RsData<Void?> =
        RsData(e.getResultCode(), e.getMsg())
}
```

# ì£¼ìš” í¬ì¸íŠ¸


## ì›ë˜ Java ì½”ë“œ ë²„ì „

```java
@ExceptionHandler(MethodArgumentNotValidException.class)
@ResponseBody
public RsData<Void> handleException(MethodArgumentNotValidException e) {
    String message = e.getBindingResult()
        .getAllErrors()
        .stream()
        .filter(error -> error instanceof FieldError)
        .map(error -> (FieldError) error)
        .map(error -> error.getField() + "-" + error.getCode() + "-" + error.getDefaultMessage())
        .sorted(Comparator.comparing(String::toString))
        .collect(Collectors.joining("\n"));

    return new RsData<>("400-1", message);
}
```

## ğŸ’¬ ì´ ì½”ë“œì˜ ë™ì‘ ìˆœì„œ

1.	getAllErrors() â†’ ëª¨ë“  ObjectError ëª©ë¡ì„ ê°€ì ¸ì˜´.<br>
(ì—¬ê¸°ì—” í•„ë“œ ê²€ì¦ ì˜¤ë¥˜(FieldError)ì™€ ê¸€ë¡œë²Œ ì˜¤ë¥˜ê°€ ì„ì—¬ ìˆìŒ.)
2.	.filter(error -> error instanceof FieldError) <br>
â†’ í•„ë“œ ë‹¨ìœ„ ì˜¤ë¥˜ë§Œ ë‚¨ê¹€.
3.	.map(error -> (FieldError) error)<br>
â†’ í˜•ë³€í™˜í•´ì„œ í•„ë“œ ì´ë¦„, ì½”ë“œ, ë©”ì‹œì§€ì— ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¦.
4.	.map(error -> "í•„ë“œëª…-ì½”ë“œ-ë©”ì‹œì§€")<br>
â†’ ë¬¸ìì—´ í˜•íƒœë¡œ ë³€í™˜.
5.	.sorted(Comparator.comparing(String::toString))<br>
â†’ ì •ë ¬ (ì˜ˆ: title-NotBlank â†’ title-Size ìˆœ)
6.	.collect(Collectors.joining("\n"))<br>
â†’ ì—¬ëŸ¬ ì¤„ì˜ ë¬¸ìì—´ë¡œ í•©ì¹¨.

## Kotlin ë²„ì „ì´ í•˜ëŠ” ì¼ â€” ì™„ì „íˆ ë™ì¼í•œ íë¦„

```kotlin
val message = e.bindingResult.allErrors
    .filterIsInstance<FieldError>()
    .sortedWith(compareBy({ it.field }, { it.code }))
    .joinToString("\n") { "${it.field}-${it.code}-${it.defaultMessage}" }
```

| Kotlin ì½”ë“œ | Java Stream ì½”ë“œ | ì—­í•  |
|:----|:----|:----|
|e.bindingResult.allErrors | e.getBindingResult().getAllErrors() | ëª¨ë“  ì˜¤ë¥˜ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸° |
|.filterIsInstance<FieldError>() | .filter(error -> error instanceof FieldError) | FieldErrorë§Œ í•„í„°ë§ |
|.sortedWith(compareBy({ it.field }, { it.code })) | .sorted(Comparator.comparing(String::toString)) | í•„ë“œëª… â†’ ì½”ë“œ ìˆœìœ¼ë¡œ ì •ë ¬ |
|.joinToString("\n") { "${it.field}-${it.code}-${it.defaultMessage}" } | .map(error -> "field-code-message").collect(Collectors.joining("\n"))| ë¬¸ìì—´ë¡œ í•©ì³ì„œ ë°˜í™˜ |


## ğŸ” ì„¸ë¶€ ë¬¸ë²• ì°¨ì´ í•´ì„¤

### `filterIsInstance<FieldError>()`
> Java: `.filter(error -> error instanceof FieldError).map(error -> (FieldError) error)`

Kotlinì€ instanceof + ìºìŠ¤íŒ…ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” í¸ì˜ í•¨ìˆ˜ê°€ ìˆìŒ.
ì¦‰, FieldError íƒ€ì…ì¸ ìš”ì†Œë§Œ ë‚¨ê¸°ê³  ìë™ìœ¼ë¡œ ìºìŠ¤íŒ…ê¹Œì§€ ìˆ˜í–‰í•´ ì¤Œ.

ê·¸ë˜ì„œ filterIsInstance<FieldError>() í•œ ì¤„ì´ë©´ .filter + .map + cast ì„¸ ì¤„ì„ ëŒ€ì²´.

### `compareBy({ it.field }, { it.code })`
> Java: `.sorted(Comparator.comparing(String::toString))`

Kotlinì—ì„œëŠ” ì—¬ëŸ¬ í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•  ë•Œ compareByë¥¼ ì“´ë‹¤.
ì—¬ê¸°ì„ 
1. ë¨¼ì € field (í•„ë“œëª…)
2. ê·¸ë‹¤ìŒ code (ê²€ì¦ ì–´ë…¸í…Œì´ì…˜ ì´ë¦„)

ìˆœìœ¼ë¡œ ì •ë ¬ ê¸°ì¤€ì„ ì¤€ ê±°ì„

ì¦‰,
title-NotBlank
title-Size
ì´ëŸ° ìˆœì„œê°€ ë³´ì¥ë˜ë„ë¡ ì •ë ¬

### `joinToString("\n") { "${it.field}-${it.code}-${it.defaultMessage}" }`
> Java: `.map(error -> "field-code-message").collect(Collectors.joining("\n"))`

Kotlinì˜ joinToString()ì€ Collectors.joining()ì˜ ë‹¨ì¶• ë²„ì „.
map + joinì„ í•œ ë²ˆì— ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ

-	`${it.field}-${it.code}-${it.defaultMessage}` ëŠ” ë¬¸ìì—´ í…œí”Œë¦¿.
(Javaì˜ "field-" + error.getCode() + "-" + ... ì™€ ê°™ìŒ.)
-	"\n" ì€ ì¤„ë°”ê¿ˆ êµ¬ë¶„ì.

