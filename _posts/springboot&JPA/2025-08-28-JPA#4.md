---
title: "[JPA]SpringBoot&JPA#4"
excerpt: ""

categories:
  - JPA

date: 2025-08-28"
last_modified_at: 2025-08-28"
---

[공식 Jpa 문서](https://docs.spring.io/spring-data/jpa/reference/jpa/getting-started.html)

[Jpa api](https://docs.spring.io/spring-data/jpa/reference/api/java/index.html)

## JpaRepository 인터페이스

```java
public interface PostRepository extends JpaRepository<Post, Integer> {
}
```

### JpaRepository

[JpaRepository](https://docs.spring.io/spring-data/jpa/reference/api/java/org/springframework/data/jpa/repository/JpaRepository.html)

Spring Data JPA에서 제공하는 인터페이스로,
기본적인 CRUD 기능을 자동으로 제공해주는 레포지토리 기반

상속받으면 구현 없이도 기본 메서드를 사용할 수 있고, 추가 구현 없이 대부분의 데이터 작업 가능함

- save(entity): 엔티티 저장 또는 수정
- findById(id): ID로 조회
- findAll(): 전체 조회
- delete(entity): 삭제
- count(): 총 개수 반환

[![2025-08-28-22-35-23.png](https://i.postimg.cc/vB3q30Pd/2025-08-28-22-35-23.png)](https://postimg.cc/YGLzSzKX)

### yml 설정

```yml
  jpa:
    properties:
      hibernate:
        format_sql: true
        highlight_sql: true
        use_sql_comments: true
    hibernate:
      ddl-auto: update
    show-sql: true

logging:
  level:
    org.hibernate.orm.jdbc.bind: TRACE
    org.hibernate.orm.jdbc.extract: TRACE

```

> 💡 yml 설정시에는 항상 들여쓰기 주의 ⚠️

| 설정 키                               | 설명                                                                               |
| :------------------------------------ | :--------------------------------------------------------------------------------- |
| show-sql                              | 콘솔에 SQL 쿼리 출력 (System.out 사용)                                             |
| hibernate.ddl-auto                    | DB 스키마 자동 생성/업데이트 옵션                                                  |
| properties.hibernate.format_sql       | SQL을 포맷팅해서 보기 좋게 출력                                                    |
| properties.hibernate.highlight_sql    | SQL 로그에 색상을 추가 (IDE/콘솔에 색상 적용 가능 시)                              |
| properties.hibernate.use_sql_comments | 실행되는 SQL 쿼리 앞에 주석 추가 (로깅 분석에 도움)                                |
| org.hibernate.orm.jdbc.bind           | 바인딩되는 파라미터 값 출력(예: ?에 어떤 값이 들어가는지 보여줌)                   |
| org.hibernate.orm.jdbc.extract        | 쿼리 결과를 어떻게 추출했는지 로그로 출력(ResultSet에서 데이터를 꺼내는 과정 표시) |

> logging.level 옵션에 [org.hibernate.SQL: debug]만 주게되면 sql 쿼리문만 보여줌

#### hibernate.ddl-auto 주요 옵션

- none: 아무것도 하지 않음 (기본값)
- create: 실행 시 테이블을 새로 생성 (기존 테이블 삭제됨)
- create-drop: create와 같지만 앱 종료 시 테이블 삭제
- update: 변경된 엔티티에 맞춰 테이블 자동 수정
- validate: 엔티티와 테이블 구조가 맞는지만 확인(수정 안해줌)
- auto: Spring Boot가 적절히 판단해 자동 선택(권장하지 않음)

### JpaRepository 사용 예

```java
@Configuration
public class BaseInitData {

    @Autowired
    private PostRepository postRepository;

    @Bean
    ApplicationRunner initDataRunner() {
        return args -> {
            Post post1 = new Post("제목1", "내용1");
            postRepository.save(post1);

            postRepository.findById(4);
        };
    }
}
```

- @Configuration 어노테이션이 붙어 있어 설정 클래스로 spring이 인식
- 내부에 정의된 @Bean메서드는 스프링 컨테이너에 등록됨
- @Autowired로 PostRepository 빈 자동 주입 받음

🌱 @Bean

- 이 메서드는 애플리케이션 실행 시 자동으로 실행될 로직을 정의
- 메서드가 반환하는 객체는 ApplicationRunner 타입의 빈이 된다

🌱 ApplicationRunner

- Spring Boot의 ApplicationRunner는 앱이 완전히 실행된 후(@PostConstruct보다 늦게) 실행
- 일반적으로 초기화 로직, 테스트 데이터 삽입, 외부 연결 확인 등에 쓰임

🌱 postRepository.save(post1);

- 생성한 post1객체를 저장

🌱 postRepository.findById(4);

- ID가 4인 Post를 DB에서 조회

### 할아버지 CrudRepository

> [curdRepository](https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html) > </br>
> 기본적인 CRUD 기능을 정의한 인터페이스 </br>
> JpaRepository, PagingAndSortingRepository등이 상속하고 있음

[![2025-08-28-23-06-04.png](https://i.postimg.cc/JnVxx93g/2025-08-28-23-06-04.png)](https://postimg.cc/VSgXLZVB)
