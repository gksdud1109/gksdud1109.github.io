---
title: "[JPA]@Autowired, @entity"
date: 2025-09-08 09:00:00 +0900
categories: [Spring]
tags: [java, jpa, spring, backend]
---
# @Autowired

- ìŠ¤í”„ë§ì˜ ì˜ì¡´ì„± ì£¼ì…(DI)ì„ ìœ„í•œ ì–´ë…¸í…Œì´ì…˜
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ë¹ˆì„ ìë™ìœ¼ë¡œ ì£¼ì…ë°›ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
- ìƒì„±ì, í•„ë“œ, ë©”ì„œë“œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- ìƒì„±ì ì£¼ì…ì´ ê°€ì¥ ê¶Œì¥ë˜ëŠ” ë°©ì‹ì´ë‹¤

- í•„ë“œ ì£¼ì…ì€ í…ŒìŠ¤íŠ¸ê°€ ì–´ë µê³  ìˆœí™˜ ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆì–´ ì§€ì–‘ëœë‹¤.

### ìˆœí™˜ì°¸ì¡°

- Aí´ë˜ìŠ¤ê°€ Bí´ë˜ìŠ¤ë¥¼ ì˜ì¡´í•˜ê³ , Bí´ë˜ìŠ¤ë„ Aí´ë˜ìŠ¤ë¥¼ ì˜ì¡´í•˜ëŠ” ìƒí™©
- ì„œë¡œê°€ ì„œë¡œë¥¼ í•„ìš”ë¡œ í•´ì„œ ìŠ¤í”„ë§ì´ ë¹ˆì„ ìƒì„±í•  ìˆ˜ ì—†ë‹¤.

```java
@Component
public class A {

    @Autowired
    private B b;

    public void doSomething() {
        System.out.println("A is doing something");
    }
}
```

```java
@Component
public class B {

    @Autowired
    private A a;

    public void doSomething() {
        System.out.println("B is doing something");
    }
}
```

- ë‘ í´ë˜ìŠ¤ê°€ ì„œë¡œë¥¼ í•„ë“œë¡œ ì˜ì¡´í•˜ëŠ” ìƒí™©,
- ë¬´í•œë£¨í”„ì²˜ëŸ¼ ì„œë¡œë¥¼ ìš”êµ¬í•´ì„œ BeanCurrentlyInCreationExceptionì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤
- ì¢€ ë¡œë§¨í‹± í•˜ë„¤ìš”...

### ìƒì„±ì ì£¼ì…

```java
@Component
public class A {
    private final B b;

    public A(B b) {
        this.b = b;
    }
}
```

```java
@Component
public class B {
    private final A a;

    public B(A a) {
        this.a = a;
    }
}
```

- ìœ„ ì½”ë“œë„ ìˆœí™˜ ì°¸ì¡°ì´ê³  ìµœì‹  ìŠ¤í”„ë§ì—ì„œëŠ” ìˆœí™˜ ì°¸ì¡° ìì²´ê°€ ê¸ˆì§€
- í•˜ì§€ë§Œ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •(spring.main.allow-circular-references=true)ì„ í•˜ë©´ Springì´ ObjectFactory, í”„ë¡ì‹œ, ì§€ì—° ì´ˆê¸°í™” ë“±ì„ í™œìš©í•´ ìˆœí™˜ì„ í•´ê²°í•  ìˆ˜ ìˆìŒ

> ğŸ’¡ í•„ë“œ ì£¼ì…ì´ ë” ìœ„í—˜í•œ ì´ìœ 
>
> - ê°ì²´ ìƒì„±ê³¼ DIê°€ ë¶„ë¦¬ë˜ì–´ ìˆì–´ ìˆœí™˜ì„ ê¹¨ëŠ” ì‹œì ì´ ì• ë§¤í•¨
> - í…ŒìŠ¤íŠ¸ë‚˜ ëª…ì‹œì  ì£¼ì…ì´ ë¶ˆê°€ëŠ¥ â†’ mock ì£¼ì… ì–´ë ¤ì›€
> - ìƒì„±ìì²˜ëŸ¼ ì´ˆê¸°í™” ë‹¨ê³„ì—ì„œ ìˆœí™˜ì„ ì¡°ì •í•  ìˆ˜ ìˆëŠ” ì—¬ì§€ê°€ ì—†ìŒ

# @Entity

```java
@Entity
@Setter
@Getter
@RequiredArgsConstructor
public class Post {

    @Id
    @GeneratedValue(strategy = jakarta.persistence.GenerationType.IDENTITY)
    private int id;
    private final String title;
    @Column(columnDefinition = "TEXT")
    private final String content;

    public Post() {
        this.title = "";
        this.content = "";
    }
}
```

- @EntityëŠ” JPAê°€ ê´€ë¦¬í•˜ëŠ” ì—”í‹°í‹°(í…Œì´ë¸” ë§¤í•‘ ëŒ€ìƒ)ì„ì„ ëª…ì‹œí•˜ëŠ” ì–´ë…¸í…Œì´ì…˜
- JPAê°€ DBí…Œì´ë¸”ë¡œ ë§¤í•‘í•  ì¤€ë¹„ë¥¼ í•˜ê³  ì´ì— ë”°ë¼ ë°˜ë“œì‹œ @Id(ê¸°ë³¸í‚¤)ë¥¼ ê°€ì ¸ì•¼ í•œë‹¤

  - ì—†ë‹¤ë©´ javax.persistence.PersistenceException ì˜ˆì™¸ ë°œìƒ

- @Getter, @SetterëŠ” Lombokì˜ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëª¨ë“  í•„ë“œì— ëŒ€í•œ ê²Œí„°ì„¸í„°ë¥¼ ìë™ ìƒì„±í•´ì¤€ë‹¤

- @RequiredArgsConstructor
  </br> â†’ final í•„ë“œë¥¼ ì¸ìë¡œ ë°›ëŠ” ìƒì„±ìë¥¼ ìƒì„±í•¨.
  ì¦‰, titleê³¼ contentë¥¼ ë§¤ê°œë¡œ ë°›ëŠ” ìƒì„±ìê°€ ìƒì„±ë¨.

- í•˜ì§€ë§Œ finalë¡œ ì„ ì–¸ì‹œ ë³€ê²½ì„ ëª»í•˜ë¯€ë¡œ ì €ë ‡ê²Œ ì„ ì–¸í•˜ë©´ ì•ˆëœë‹¤.
- idì˜ ê²½ìš°ì—” ë³€ê²½í•  ì¼ì´ ì—†ê¸° ë•Œë¬¸ì— finalë¡œ í•´ë„ ë˜ì§€ë§Œ, ê°„ê²°í•œ ì½”ë“œë¥¼ ìœ„í•´ ìƒëµí•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ

## JPA Entity í…Œì´ë¸” ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ë“¤

### @Entity

- jpaê°€ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ì„ì„ ë‚˜íƒ€ëƒ„ -> DBí…Œì´ë¸”ê³¼ ë§¤í•‘
- í•´ë‹¹ í´ë˜ìŠ¤ëŠ” ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜, @Id í•„ë“œ í•„ìˆ˜

<hr>

### @Table

- ë§¤í•‘ë  í…Œì´ë¸” ì´ë¦„ì´ë‚˜ ddlì˜µì…˜ì„ ëª…ì‹œ

```java
@Entity
@Table(name = "posts", uniqueConstraints = @UniqueConstraint(columnNames = {"title"}))
```

- name: ë§¤í•‘í•  í…Œì´ë¸” ì´ë¦„
- schema: ì‚¬ìš©í•  DBìŠ¤í‚¤ë§ˆ ì´ë¦„
- uniqueConstraints: ìœ ë‹ˆí¬ ì œì•½ ì¡°ê±´ ì„¤ì •

<hr>

### @Id

- ê¸°ë³¸ í‚¤(PK)ë¥¼ ë‚˜íƒ€ëƒ„. ë°˜ë“œì‹œ í•˜ë‚˜ í•„ìš”

<hr>

### @GeneratedValue

- ê¸°ë³¸ í‚¤ ê°’ ìë™ ìƒì„± ì „ëµ ì„¤ì •

[JPA ê¸°ë³¸í‚¤ ìƒì„± ì „ëµ, @GeneratedValue ì‚¬ìš©ì‹œ ì£¼ì˜ì ](https://devcamus.tistory.com/16)

```java
@GeneratedValue(strategy = GenerationType.IDENTITY)
```

#### ì „ëµ

- IDENTITY: ê¸°ë³¸ í‚¤ ìƒì„±ì„ dbì— ìœ„ì„ -> mysqlì˜ ê²½ìš° auto_increment ì „ëµì„ ì‚¬ìš©í•œë‹¤
- SEQUENCE: dbì‹œí€¸ìŠ¤ ì‚¬ìš© -> dbì‹œí€¸ìŠ¤ëŠ” ìœ ì¼í•œ ê°’ì„ ìˆœì„œëŒ€ë¡œ ìƒì„±í•˜ëŠ” íŠ¹ë³„í•œ ì˜¤ë¸Œì íŠ¸(ex. ì˜¤ë¼í´ ì‹œí€¸ìŠ¤)
- TABLE: í‚¤ ìƒì„± ì „ìš© í…Œì´ë¸”ì„ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ dbì‹œí€¸ìŠ¤ë¥¼ í‰ë‚´ë‚´ëŠ” ì „ëµ -> ì„±ëŠ¥ì ìœ¼ë¡œ êµ¬ë¦¼
- AUTO: hibernate.dialectì— ì„¤ì •ëœ dbë°©ì–¸ ì¢…ë¥˜ì— ë”°ë¼, í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ìë™ìœ¼ë¡œ ì „ëµì„ ì„ íƒí•˜ê²Œë” ìœ„ì„ -> ê¸€ì— ë‚˜ì™€ ìˆë“¯ì´ ì˜ëª¨ë¥´ê³  ì‚¬ìš©í•˜ë©´ ìœ„í—˜âŒ

<hr>

### @Column

- í•„ë“œë¥¼ ì»¬ëŸ¼ê³¼ ë§¤í•‘í•˜ê³  ìƒì„¸ ì„¤ì • ê°€ëŠ¥

```java
@Column(name = "title", nullable = false, unique = true, length = 100)
```

- name: dbì¹¼ëŸ¼ ì´ë¦„
- nullable: NOT NULL ì—¬ë¶€
- length: ë¬¸ìì—´ ê¸¸ì´ ì œí•œ(ê¸°ë³¸ 255)
- unique: ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´
- columnDefinition: dbë°ì´í„° íƒ€ì… ì§ì ‘ ëª…ì‹œ(ex. "TEXT", "varchar(100 default 'Y'"))

<hr>

### @Lob

- ëŒ€ìš©ëŸ‰ ë°ì´í„°(í…ìŠ¤íŠ¸ë‚˜ ë°”ì´ë„ˆë¦¬) ì €ì¥ìš©
- @Column(columnDefinition = "TEXT")ì˜ ëŒ€ì•ˆ

<hr>

### @Enumerated

- enumíƒ€ì…ì„ dbì— ì–´ë–»ê²Œ ì €ì¥í• ì§€ ê²°ì •

```java
@Enumerated(EnumType.STRING)
private PostStatus status;
```

- ORDINAL(ìŠ¤í ë§ í‹€ë¦°ê±° ì•„ë‹˜): enumì˜ ìˆœì„œë¥¼ ìˆ«ìë¡œ ì €ì¥ -> enumíƒ€ì… ë³€ê²½ì‹œ ìˆ«ì ëŒ€ì‘ì´ í‹€ë¦´ ìœ„í—˜âŒ
- STRING: enum ì´ë¦„ì„ ë¬¸ìì—´ë¡œ ì €ì¥

<hr>

### @CreationTimestamp / @UpdateTimestamp

- Hibernateê°€ ì œê³µ(JPA âŒ)
- ìë™ìœ¼ë¡œ ìƒì„±/ìˆ˜ì • ì‹œê°„ ì €ì¥

```java
@CreationTimestamp
private LocalDateTime createdAt;

@UpdateTimestamp
private LocalDateTime updatedAt;
```

<hr>

### @Transient

- dbì— ì €ì¥í•˜ì§€ ì•Šì„ í•„ë“œ ì§€ì •(ex. ê³„ì‚°ê°’, DTO ë³€í™˜ìš© ë“±)

```java
@Transient
private String notSavedField;
```

<hr>

### @Embeddable / @Embedded

- ê°’ íƒ€ì… ê°ì²´ë¥¼ í…Œì´ë¸”ì— í•¨ê¼ ì €ì¥í•  ë–„ ì‚¬ìš© (ex. ì£¼ì†Œ, ì´ë¦„ ë“± ë³µí•© ê°’)

```java
@Embeddable
public class Address {
    private String city;
    private String street;
}

@Embedded
private Address address;
```

- Embeddable: ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³
- Embedded: ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³
- ì„ë² ë“œ íƒ€ì…ì€ ê¸°ë³¸ ìƒì„±ìê°€ í•„ìˆ˜ì„

<hr>

### @MappedSuperclass

- ê³µí†µ í•„ë“œë§Œ ì •ì˜í•œ ë¶€ëª¨ í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©
- ì‹¤ì œ í…Œì´ë¸”ì€ ìƒì„±ë˜ì§€ ì•ŠìŒ

```java
@MappedSuperclass
public abstract class BaseEntity {
    @CreatedDate
    private LocalDateTime createdAt;
}
```

<hr>

### @Access

- jpaê°€ í•„ë“œ ë˜ëŠ” getter/setter ê¸°ì¤€ìœ¼ë¡œ ì ‘ê·¼í• ì§€ ì„¤ì •

```java
@Access(AccessType.FIELD)
private String title;
```

## ìµœì¢… ë³€ê²½ëœ postê°ì²´

```java
@Entity
@Setter
@Getter
@NoArgsConstructor
@EntityListeners(AuditingEntityListener.class)
public class Post {

    @Id
    @GeneratedValue(strategy = jakarta.persistence.GenerationType.IDENTITY)
    private int id;
    private String title;
    @Column(columnDefinition = "TEXT")
    private String content;

    @CreatedDate
    private LocalDateTime createDate;

    @LastModifiedDate
    private LocalDateTime modifyDate;

    public Post(String title, String content) {
        this.title = title;
        this.content = content;
    }
}
```

```java
@SpringBootApplication
@EnableJpaAuditing
public class DemoApplication {
  ...
}
```

- ì—¬ê¸°ì— @EnableJpaAuditingì„ ë¶™ì—¬ì¤˜ì•¼ @CreatedDate/@LastModifiedDate ì–´ë…¸í…Œì´ì…˜ì´ ì œëŒ€ë¡œ ë™ì‘

- [JPA - Auditing íŠœí† ë¦¬ì–¼](https://docs.spring.io/spring-data/jpa/reference/auditing.html)
